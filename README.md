# Fieldr

Generator of various enumerated constants, types, functions based on structure fields and their tags.

## Supported commands

* enum-const - generate constants based on template applied to struct fields.
* as-map - generates method or functon that converts the struct type to a map.
* builder - generates builder API of a structure type.

## Installation

```bash
go install github.com/m4gshm/fieldr@latest
```
or
```bash
go install github.com/m4gshm/fieldr@HEAD
```
## Enum constant example

create a file `entity.go` with the below content:

```go
package enum_const

//go:generate fieldr -type Entity enum-const -val .json -list jsons
type Entity struct {
    Id   int    `json:"id"`
    Name string `json:"name"`
}
```

then running this command in the same directory:

```bash script
go generate .
```

will be generated `entity_fieldr.go` file with the next content:

```go
// Code generated by 'fieldr'; DO NOT EDIT.

package enum_const

const (
    entityJsonId   = "id"
    entityJsonName = "name"
)

func jsons() []string { return []string{entityJsonId, entityJsonName} }
```

this consist of constants based on the `json` tag contents and the method `jsons` that enumerates these constants.

To get extended help of the command, use the following:

```bash
fieldr enum-const --help
```

## Builder usage example

source `entity.go`

```go
package builder

//go:generate fieldr -type Entity builder -deconstructor .
type Entity[ID any] struct {
	*Model[ID]
	Name string
}

type Model[ID any] struct {
	ID        ID
	CreatedAt int64
	UpdatedAt int64
}
```

```bash script
go generate .
```

generated `entity_fieldr.go`

```go
// Code generated by 'fieldr'; DO NOT EDIT.

package builder

type EntityBuilder[ID any] struct {
	iD        ID
	createdAt int64
	updatedAt int64
	name      string
}

func NewEntityBuilder[ID any]() *EntityBuilder[ID] {
	return &EntityBuilder[ID]{}
}

func (b *EntityBuilder[ID]) Build() *Entity[ID] {
	if b == nil {
		return &Entity[ID]{}
	}
	return &Entity[ID]{
		Model: &Model[ID]{
			ID:        b.iD,
			CreatedAt: b.createdAt,
			UpdatedAt: b.updatedAt,
		},
		Name: b.name,
	}
}

func (b *EntityBuilder[ID]) ID(iD ID) *EntityBuilder[ID] {
	if b != nil {
		b.iD = iD
	}
	return b
}

func (b *EntityBuilder[ID]) CreatedAt(createdAt int64) *EntityBuilder[ID] {
	if b != nil {
		b.createdAt = createdAt
	}
	return b
}

func (b *EntityBuilder[ID]) UpdatedAt(updatedAt int64) *EntityBuilder[ID] {
	if b != nil {
		b.updatedAt = updatedAt
	}
	return b
}

func (b *EntityBuilder[ID]) Name(name string) *EntityBuilder[ID] {
	if b != nil {
		b.name = name
	}
	return b
}

func (i *Entity[ID]) ToBuilder() *EntityBuilder[ID] {
	if i == nil {
		return &EntityBuilder[ID]{}
	}
	var i_Model_ID ID
	if i.Model != nil {
		i_Model_ID = i.Model.ID
	}
	var i_Model_CreatedAt int64
	if i.Model != nil {
		i_Model_CreatedAt = i.Model.CreatedAt
	}
	var i_Model_UpdatedAt int64
	if i.Model != nil {
		i_Model_UpdatedAt = i.Model.UpdatedAt
	}

	return &EntityBuilder[ID]{
		iD:        i_Model_ID,
		createdAt: i_Model_CreatedAt,
		updatedAt: i_Model_UpdatedAt,
		name:      i.Name,
	}
}
```

 See more examples [here](./examples/)